import os

# Get the full path of the current script and split into parts
script_dir = os.path.dirname(os.path.abspath(__file__))
path_parts = script_dir.split(os.sep)

# Extract the desired base path (up to 'GPP_DMV_Engine/Accounts')
try:
    base_path = os.path.join(*path_parts[:path_parts.index('GPP_DMV_Engine') + 2])
except ValueError:
    raise Exception("GPP_DMV_Engine not found in the current path.")

# Define the output directory and ensure it exists
output_dir = os.path.join(base_path, 'data', 'output_data')
os.makedirs(output_dir, exist_ok=True)  # Efficiently creates directories if they don't exist

# Final file path
file_path = os.path.join(output_dir, 'Skipped-Records.csv')

# Use file_path to save the file
print(f"File will be saved at: {file_path}")
