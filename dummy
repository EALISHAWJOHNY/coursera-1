# polls/forms.py
from django import forms

class SourceFileForm(forms.Form):
    source_file = forms.FileField(label='Source File')

class TargetFileForm(forms.Form):
    target_file = forms.FileField(label='Target File')

# polls/views.py
from django.shortcuts import render
from formtools.wizard.views import SessionWizardView
from .forms import SourceFileForm, TargetFileForm
from django.core.files.storage import FileSystemStorage
import os

class FileUploadWizard(SessionWizardView):
    template_name = 'polls/step_form.html'
    form_list = [SourceFileForm, TargetFileForm]

    def done(self, form_list, **kwargs):
        source_file = form_list[0].cleaned_data['source_file']
        target_file = form_list[1].cleaned_data['target_file']

        # Define the paths for saving the files in the Accounts app
        accounts_dir = os.path.join(os.path.dirname(os.path.dirname(__file__)), 'Accounts', 'data', 'input')
        
        source_path = os.path.join(accounts_dir, 'sourcefile', source_file.name)
        target_path = os.path.join(accounts_dir, 'targetfile', target_file.name)

        # Save the files to the specified locations
        with open(source_path, 'wb+') as destination:
            for chunk in source_file.chunks():
                destination.write(chunk)

        with open(target_path, 'wb+') as destination:
            for chunk in target_file.chunks():
                destination.write(chunk)

        return render(self.request, 'polls/done.html', {
            'source_file': source_file,
            'target_file': target_file
        })


<!-- polls/templates/polls/step_form.html -->
<!DOCTYPE html>
<html>
<head>
    <title>File Upload Wizard</title>
</head>
<body>
    <h2>Step {{ wizard.steps.step1 }} of 3</h2>
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        {{ wizard.management_form }}
        {{ wizard.form.as_p }}
        <button type="submit">Next</button>
    </form>
</body>
</html>


<!-- polls/templates/polls/done.html -->
<!DOCTYPE html>
<html>
<head>
    <title>Files Uploaded</title>
</head>
<body>
    <h2>Files Uploaded Successfully</h2>
    <p>Source File: {{ source_file.name }}</p>
    <p>Target File: {{ target_file.name }}</p>
</body>
</html>


# polls/urls.py
from django.urls import path
from .views import FileUploadWizard
from .forms import SourceFileForm, TargetFileForm

urlpatterns = [
    path('upload/', FileUploadWizard.as_view([SourceFileForm, TargetFileForm]), name='upload'),
]


# mysite/urls.py
from django.contrib import admin
from django.urls import path, include

urlpatterns = [
    path('admin/', admin.site.urls),
    path('polls/', include('polls.urls')),
]

python manage.py migrate
python manage.py runserver



<!-- polls/templates/polls/base.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File Upload Wizard</title>
    <!-- Bootstrap CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container">
        {% block content %}
        {% endblock %}
    </div>
    <!-- Bootstrap JS, Popper.js, and jQuery -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>


<!-- polls/templates/polls/step_form.html -->
{% extends 'polls/base.html' %}


modified step_form html


{% block content %}
<div class="card mt-5">
    <div class="card-body">
        <h2 class="card-title">File Upload Wizard</h2>
        <div class="progress">
            <div class="progress-bar" role="progressbar" style="width: {{ wizard.steps.step1|add:'1'|div:3|mul:100 }}%" aria-valuenow="{{ wizard.steps.step1|add:'1' }}" aria-valuemin="0" aria-valuemax="3"></div>
        </div>
        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
            {{ wizard.management_form }}

            <!-- Stepper Navigation -->
            <ul class="nav nav-pills mt-3">
                <li class="nav-item">
                    <a class="nav-link {% if wizard.steps.current == '0' %}active{% endif %}" href="#">Step 1: Upload Source File</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link {% if wizard.steps.current == '1' %}active{% endif %}" href="#">Step 2: Upload Target File</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link {% if wizard.steps.current == '2' %}active{% endif %}" href="#">Step 3: Submit</a>
                </li>
            </ul>

            <div class="mt-4">
                {{ wizard.form.as_p }}
                <button type="submit" class="btn btn-primary float-right">
                    {% if wizard.steps.last %}Submit{% else %}Next{% endif %}
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}
