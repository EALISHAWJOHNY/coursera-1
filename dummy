<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Horizontal Stepper</title>
    <!-- Bootstrap CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <!-- bs-stepper CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bs-stepper/dist/css/bs-stepper.min.css" rel="stylesheet">
</head>
<body>
    {% block content %}
    {% endblock %}

    <!-- Bootstrap JS and dependencies -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <!-- bs-stepper JS -->
    <script src="https://cdn.jsdelivr.net/npm/bs-stepper/dist/js/bs-stepper.min.js"></script>
</body>
</html>


{% extends 'base.html' %}
{% extends 'base.html' %}

{% block content %}
<div class="container mt-5">
    <div class="card">
        <div class="card-header">
            <h4>Horizontal Stepper for File Upload</h4>
        </div>
        <div class="card-body">
            <div id="stepper" class="bs-stepper">
                <div class="bs-stepper-header" role="tablist">
                    <!-- Stepper steps -->
                    <div class="step" data-target="#step-1">
                        <button type="button" class="step-trigger" role="tab" id="stepper-trigger-1" aria-controls="step-1">
                            <span class="bs-stepper-circle">1</span>
                            <span class="bs-stepper-label">Upload File 1</span>
                        </button>
                    </div>
                    <div class="line"></div>
                    <div class="step" data-target="#step-2">
                        <button type="button" class="step-trigger" role="tab" id="stepper-trigger-2" aria-controls="step-2">
                            <span class="bs-stepper-circle">2</span>
                            <span class="bs-stepper-label">Upload File 2</span>
                        </button>
                    </div>
                    <div class="line"></div>
                    <div class="step" data-target="#step-3">
                        <button type="button" class="step-trigger" role="tab" id="stepper-trigger-3" aria-controls="step-3">
                            <span class="bs-stepper-circle">3</span>
                            <span class="bs-stepper-label">Review & Submit</span>
                        </button>
                    </div>
                </div>
                <div class="bs-stepper-content">
                    <!-- Stepper content -->
                    <form method="POST" enctype="multipart/form-data">
                        {% csrf_token %}
                        <div id="step-1" class="content" role="tabpanel" aria-labelledby="stepper-trigger-1">
                            <div class="form-group">
                                <label for="file1">Upload File 1:</label>
                                <input type="file" class="form-control" name="file1" id="file1">
                            </div>
                            <button class="btn btn-primary" type="button" onclick="stepper.next()">Next</button>
                        </div>
                        <div id="step-2" class="content" role="tabpanel" aria-labelledby="stepper-trigger-2">
                            <div class="form-group">
                                <label for="file2">Upload File 2:</label>
                                <input type="file" class="form-control" name="file2" id="file2">
                            </div>
                            <button class="btn btn-primary" type="button" onclick="stepper.next()">Next</button>
                        </div>
                        <div id="step-3" class="content" role="tabpanel" aria-labelledby="stepper-trigger-3">
                            <div class="form-group">
                                <button type="submit" class="btn btn-success">Submit</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    var stepper = new Stepper(document.querySelector('#stepper'), {
        linear: false, // Change to true if you want to enforce step order
        animation: true
    });
</script>
{% endblock %}

<!-- BS Stepper JS -->
<script src="https://cdn.jsdelivr.net/npm/bs-stepper/dist/js/bs-stepper.min.js"></script>
<script>
    var stepper = new Stepper(document.querySelector('#stepper'))
</script>
{% endblock %}

from django.shortcuts import render
from django.core.files.storage import FileSystemStorage
from django.http import JsonResponse, HttpResponse
import os
from django.conf import settings

from django.shortcuts import render
from django.core.files.storage import FileSystemStorage
from django.http import HttpResponse
import os
from django.conf import settings

def stepper_upload(request):
    if request.method == 'POST':
        try:
            # Define the specific folders
            source_folder = os.path.join(settings.BASE_DIR, 'account/data/input_data/source_file/')
            target_folder = os.path.join(settings.BASE_DIR, 'account/data/input_data/target_file/')

            # Ensure both folders exist
            if not os.path.exists(source_folder):
                os.makedirs(source_folder)
                
            if not os.path.exists(target_folder):
                os.makedirs(target_folder)

            # Initialize file paths
            saved_path1 = None
            saved_path2 = None

            # Save the first file in the source folder
            if 'file1' in request.FILES:
                file1 = request.FILES['file1']
                fs1 = FileSystemStorage(location=source_folder)
                name1 = fs1.save(file1.name, file1)
                saved_path1 = fs1.path(name1)

            # Save the second file in the target folder
            if 'file2' in request.FILES:
                file2 = request.FILES['file2']
                fs2 = FileSystemStorage(location=target_folder)
                name2 = fs2.save(file2.name, file2)
                saved_path2 = fs2.path(name2)

            # Return response
            if saved_path1 or saved_path2:
                return HttpResponse(f'Files successfully uploaded: {saved_path1}, {saved_path2}')
            else:
                return HttpResponse('No files uploaded')

        except Exception as e:
            return HttpResponse(f'Error occurred: {str(e)}')

    return render(request, 'stepper.html')
